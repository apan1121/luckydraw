(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{102:function(t,e,i){"use strict";(function(t){var n=i(68),a=i(2),r=i(0);function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){c(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var d={ding:new Audio("./dist/mp3/ding.mp3"),winner:[new Audio("./dist/mp3/winner2.mp3")]};e.a={components:{},filters:{},props:{},data:function(){return{ValidateCandidateSN:null,ValidSNRandomRange:0,defaultRunTime:50,runTime:0}},computed:s({},Object(a.c)(["config","triggerOpenGetLucky","prizeListByAward","candidateList","haveAwardCandidateSN","getLuckyWaitTimeArr"])),watch:{triggerOpenGetLucky:{immediate:!0,handler:function(){this.triggerOpenGetLucky?t(this.$refs.box).modal("show"):t(this.$refs.box).modal("hide")}}},created:function(){},mounted:function(){var e=this;t(e.$refs.box).bind("shown.bs.modal",(function(){e.award="",r.g.mixpanel("GetLuckyOpen_click"),r.g.gtag("event","GetLuckyOpen_click")})),t(e.$refs.box).bind("hidden.bs.modal",(function(){r.g.mixpanel("GetLuckyClose_click"),r.g.gtag("event","GetLuckyClose_click")})),e.triggerOpenGetLucky?t(e.$refs.box).modal("show"):t(e.$refs.box).modal("hide")},updated:function(){},destroyed:function(){},methods:s(s({},Object(a.d)({setFavicon:"setFavicon",setFocusCandidateSN:"setFocusCandidateSN",setFocusPrizeSN:"setFocusPrizeSN",triggerModal:"triggerModal"})),{},{editPrizeList:function(){t(this.$refs.box).modal("hide"),this.triggerModal({key:"PrizeList"})},getLucky:function(e){if(r.g.mixpanel("GetLuckyChoosePrize_click",e),r.g.gtag("event","GetLuckyChoosePrize_click",e),e.count<=e.amount){var i=this.haveAwardCandidateSN,a=[];this.candidateList.forEach((function(t){!1!==t.del||i.includes(t.sn)||a.push(t.sn)})),a.length>0?(this.ValidateCandidateSN=a,this.ValidSNRandomRange=Math.pow(10,"".concat(this.ValidateCandidateSN.length).length),t(this.$refs.box).modal("hide"),this.runTime=this.config.defaultRunTime,r.g.mixpanel("GetLuckyChoosePrizeRun_trigger",e),r.g.gtag("event","GetLuckyChoosePrizeRun_trigger",e),this.setFocusCandidateSN(null),this.setFocusPrizeSN(e.prize_sn),this.luckyAction()):(r.g.mixpanel("GetLuckyChoosePrizeError_trigger",{error:"no candidate"}),r.g.gtag("event","GetLuckyChoosePrizeError_trigger",{error:"no candidate"}),n.a.warning({html:"無候選人可以抽"}))}else r.g.mixpanel("GetLuckyChoosePrizeError_trigger",{error:"not enough"}),r.g.gtag("event","GetLuckyChoosePrizeError_trigger",{error:"not enough"}),n.a.warning({html:"此獎項沒有足夠的數量"})},luckyAction:function(){var t=this,e=parseInt(1e5*Math.random()%t.ValidateCandidateSN.length);t.setFocusCandidateSN(t.ValidateCandidateSN[e]),d.ding.play(),t.setFavicon("run");var i=t.getLuckyWaitTimeArr;if(t.runTime>0&&t.ValidateCandidateSN.length>1){var n=0;for(var a in i)if(t.runTime>=i[a].limit){n=i[a].wait;break}t.runTime-=1,clearTimeout(t.luckyActionTimer),t.luckyActionTimer=setTimeout((function(){d.ding.pause(),d.ding.currentTime=0,t.luckyAction()}),n)}else setTimeout((function(){r.g.mixpanel("GetLuckyChoosePrizeStop_trigger"),r.g.gtag("event","GetLuckyChoosePrizeStop_trigger"),t.triggerModal({key:"Lucky"});var e=parseInt(10*Math.random()%d.winner.length);d.winner[e].play()}),600)}})}}).call(this,i(14))},358:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"box",staticClass:"modal",attrs:{id:"GetLuckyBox",tabindex:"-1",role:"dialog","data-backdrop":"static","data-keyboard":"false"}},[i("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[i("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"get-lucky-list"},[t.prizeListByAward.length>0?t._l(t.prizeListByAward,(function(e){return i("button",{key:e.prize_sn,staticClass:"btn btn-success btn-lg btn-block mb-3 prizeInfo",attrs:{type:"button",disabled:e.amount<=e.count},on:{click:function(i){return t.getLucky(e)}}},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-9"},[t._v("\n                                    "+t._s(e.title)+"\n                                ")]),t._v(" "),i("div",{staticClass:"col-3"},[t._v("\n                                    ["+t._s(e.count)+" / "+t._s(e.amount)+"]\n                                ")])])])})):[i("h4",{staticClass:"text-center p-3"},[t._v("\n                            您尚未建立獎項，無法進行抽獎\n                        ")]),t._v(" "),i("button",{staticClass:"btn btn-warning btn-block btn-lg",on:{click:t.editPrizeList}},[t._v("\n                            建立獎項\n                        ")])]],2)])])])])};n._withStripped=!0;var a=i(102).a,r=i(9),o=Object(r.a)(a,n,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title"},[e("i",{staticClass:"fas fa-vote-yea"}),this._v("\n                    選取獎項\n                ")]),this._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])])}],!1,null,"65e22eac",null);o.options.__file="components/GetLuckyBox/main.vue";e.default=o.exports}}]);